let e;export function __wbg_set_wasm(n){e=n}let n=null;function t(){return null!==n&&0!==n.byteLength||(n=new Uint8Array(e.memory.buffer)),n}let i=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});i.decode();let r=0;function l(e,n){return function(e,n){return r+=n,r>=2146435072&&(i=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),i.decode(),r=n),i.decode(t().subarray(e,e+n))}(e>>>=0,n)}let o=0;const s=new TextEncoder;"encodeInto"in s||(s.encodeInto=function(e,n){const t=s.encode(e);return n.set(t),{read:e.length,written:t.length}});let a=null;function g(){return(null===a||!0===a.buffer.detached||void 0===a.buffer.detached&&a.buffer!==e.memory.buffer)&&(a=new DataView(e.memory.buffer)),a}export function init_panic_hook(){e.init_panic_hook()}function c(e,n){const i=n(1*e.length,1)>>>0;return t().set(e,i/1),o=e.length,i}export function analyze_file(n){let t,i;try{const r=c(n,e.__wbindgen_malloc),s=o,a=e.analyze_file(r,s);return t=a[0],i=a[1],l(a[0],a[1])}finally{e.__wbindgen_free(t,i,1)}}export function get_file_info(n){let t,i;try{const r=c(n,e.__wbindgen_malloc),s=o,a=e.get_file_info(r,s);return t=a[0],i=a[1],l(a[0],a[1])}finally{e.__wbindgen_free(t,i,1)}}export function analyze_pe_file(n){let t,i;try{const r=c(n,e.__wbindgen_malloc),s=o,a=e.analyze_pe_file(r,s);return t=a[0],i=a[1],l(a[0],a[1])}finally{e.__wbindgen_free(t,i,1)}}export function __wbg_error_7534b8e9a36f1ab4(n,t){let i,r;try{i=n,r=t,console.error(l(n,t))}finally{e.__wbindgen_free(i,r,1)}}export function __wbg_new_8a6f238a6ece86ea(){return new Error}export function __wbg_stack_0ed75d68575b0f3c(n,i){const r=function(e,n,i){if(void 0===i){const i=s.encode(e),r=n(i.length,1)>>>0;return t().subarray(r,r+i.length).set(i),o=i.length,r}let r=e.length,l=n(r,1)>>>0;const a=t();let g=0;for(;g<r;g++){const n=e.charCodeAt(g);if(n>127)break;a[l+g]=n}if(g!==r){0!==g&&(e=e.slice(g)),l=i(l,r,r=g+3*e.length,1)>>>0;const n=t().subarray(l+g,l+r);g+=s.encodeInto(e,n).written,l=i(l,r,g,1)>>>0}return o=g,l}(i.stack,e.__wbindgen_malloc,e.__wbindgen_realloc),l=o;g().setInt32(n+4,l,!0),g().setInt32(n+0,r,!0)}export function __wbindgen_init_externref_table(){const n=e.__wbindgen_export_3,t=n.grow(4);n.set(0,void 0),n.set(t+0,void 0),n.set(t+1,null),n.set(t+2,!0),n.set(t+3,!1)}window.init=d,window.analyze_file=analyze_file,window.get_file_info=get_file_info;import d,{analyze_file,get_file_info}from"/pkg/upload_analyzer.js";let u=!1;const f=document.getElementById("status"),m=document.getElementById("results"),y=document.getElementById("output"),p=document.getElementById("fileInput"),_=document.getElementById("uploadArea");async function b(e){if(u){f.innerHTML=`<div class="info">üîç Analyzing ${e.name}...</div>`,m.style.display="none";try{const n=await e.arrayBuffer(),t=new Uint8Array(n),i=get_file_info(t),r=JSON.parse(i);let l="<h3>File Information</h3>";if(l+="<ul>",l+=`<li><strong>Filename:</strong> ${e.name}</li>`,l+=`<li><strong>Size:</strong> ${(e.size/1024).toFixed(2)} KB (${e.size.toLocaleString()} bytes)</li>`,l+=`<li><strong>Type:</strong> ${r.type||"Unknown"}</li>`,l+="</ul>",l+="<h3>Basic Information</h3>",l+=`<pre>${JSON.stringify(r,null,2)}</pre>`,r.type&&(r.type.includes("PE")||r.type.includes("MSI")||r.type.includes("DMG")))try{const e=analyze_file(t),n=JSON.parse(e);if(n.error)l+=`<div class="error">‚ö†Ô∏è Analysis error: ${n.error}</div>`;else if(l+="<h3>Binary Metadata</h3>",0===Object.keys(n).length)l+="<p>No metadata found.</p>";else{if(l+="<h4>File Header</h4>",l+="<ul>",n.Format&&(l+=`<li><strong>Format:</strong> ${n.Format}</li>`),n.InstallerType&&(l+=`<li><strong>‚öôÔ∏è Installer Type:</strong> ${n.InstallerType}</li>`),n.EmbeddedMSI&&(l+=`<li><strong>üì¶ Contains Embedded MSI:</strong> Yes (at offset ${n.MSIOffset})</li>`),n.Architecture&&(l+=`<li><strong>Architecture:</strong> ${n.Architecture}</li>`),n.Machine&&(l+=`<li><strong>Machine Type:</strong> ${n.Machine}</li>`),n.NumberOfSections&&(l+=`<li><strong>Number of Sections:</strong> ${n.NumberOfSections}</li>`),n.Characteristics&&(l+=`<li><strong>Characteristics:</strong> ${n.Characteristics}</li>`),n.PointerToSymbolTable&&(l+=`<li><strong>Symbol Table Pointer:</strong> ${n.PointerToSymbolTable}</li>`),n.NumberOfSymbols&&(l+=`<li><strong>Number of Symbols:</strong> ${n.NumberOfSymbols}</li>`),n.Timestamp){l+=`<li><strong>Compile Date:</strong> ${new Date(1e3*parseInt(n.Timestamp)).toUTCString()}</li>`}if(l+="</ul>",l+="<h4>Optional Header</h4>",l+="<ul>",n.EntryPoint&&(l+=`<li><strong>Entry Point:</strong> ${n.EntryPoint}</li>`),n.ImageBase&&(l+=`<li><strong>Image Base:</strong> ${n.ImageBase}</li>`),n.SizeOfImage&&(l+=`<li><strong>Size of Image:</strong> ${n.SizeOfImage} bytes</li>`),n.Subsystem&&(l+=`<li><strong>Subsystem:</strong> ${n.Subsystem}</li>`),n.DllCharacteristics&&(l+=`<li><strong>DLL Characteristics:</strong> ${n.DllCharacteristics}</li>`),l+="</ul>","MSI"===n.Format&&(l+="<h4>MSI Package Information</h4>",l+="<ul>",n.ProductCode&&(l+=`<li><strong>Product Code:</strong> ${n.ProductCode}</li>`),n.UpgradeCode&&(l+=`<li><strong>Upgrade Code:</strong> ${n.UpgradeCode}</li>`),n.InstallerFramework&&(l+=`<li><strong>‚öôÔ∏è Created With:</strong> ${n.InstallerFramework}</li>`),l+="</ul>"),"DMG"===n.Format&&(l+="<h4>DMG Disk Image Information</h4>",l+="<ul>",n.ImageType&&(l+=`<li><strong>Image Type:</strong> ${n.ImageType}</li>`),n.Compression&&(l+=`<li><strong>Compression:</strong> ${n.Compression}</li>`),n.HasKolySignature&&(l+=`<li><strong>UDIF Signature:</strong> ${"true"===n.HasKolySignature?"‚úì Present":"‚úó Missing"}</li>`),n.DMGVersion&&(l+=`<li><strong>DMG Version:</strong> ${n.DMGVersion}</li>`),l+="</ul>",l+="<h4>Application Bundle Information</h4>",l+="<ul>",n.BundleIdentifier&&(l+=`<li><strong>Bundle ID:</strong> ${n.BundleIdentifier}</li>`),n.ApplicationBundle&&(l+=`<li><strong>Application:</strong> ${n.ApplicationBundle}</li>`),n.ExecutableName&&(l+=`<li><strong>Executable:</strong> ${n.ExecutableName}</li>`),n.PackageType&&(l+=`<li><strong>Package Type:</strong> ${n.PackageType}</li>`),n.ApplicationCategory&&(l+=`<li><strong>üìÅ Category:</strong> ${n.ApplicationCategory}</li>`),n.MinimumSystemVersion&&(l+=`<li><strong>Min macOS:</strong> ${n.MinimumSystemVersion}</li>`),n.IconFile&&(l+=`<li><strong>Icon:</strong> ${n.IconFile}</li>`),n.PrincipalClass&&(l+=`<li><strong>Principal Class:</strong> ${n.PrincipalClass}</li>`),l+="</ul>"),l+="<h4>Version Information</h4>",l+="<ul>",n.FileVersionNumber&&(l+=`<li><strong>File Version (Binary):</strong> ${n.FileVersionNumber}</li>`),n.ProductVersionNumber&&(l+=`<li><strong>Product Version (Binary):</strong> ${n.ProductVersionNumber}</li>`),n.FileVersion&&(l+=`<li><strong>File Version (String):</strong> ${n.FileVersion}</li>`),n.ProductVersion&&(l+=`<li><strong>Product Version (String):</strong> ${n.ProductVersion}</li>`),n.SignedBy&&(l+=`<li><strong>üîê Digitally Signed By:</strong> ${n.SignedBy}</li>`),n.CompanyName){const e=n.NoStringsFound?" (from digital signature)":"";l+=`<li><strong>Company Name:</strong> ${n.CompanyName}${e}</li>`}n.Manufacturer&&(l+=`<li><strong>Manufacturer:</strong> ${n.Manufacturer}</li>`),n.ProductName&&(l+=`<li><strong>Product Name:</strong> ${n.ProductName}</li>`),n.FileDescription&&(l+=`<li><strong>File Description:</strong> ${n.FileDescription}</li>`),n.InternalName&&(l+=`<li><strong>Internal Name:</strong> ${n.InternalName}</li>`),n.OriginalFilename&&(l+=`<li><strong>Original Filename:</strong> ${n.OriginalFilename}</li>`),n.LegalCopyright&&(l+=`<li><strong>Legal Copyright:</strong> ${n.LegalCopyright}</li>`),n.LegalTrademarks&&(l+=`<li><strong>Legal Trademarks:</strong> ${n.LegalTrademarks}</li>`),n.Comments&&(l+=`<li><strong>Comments:</strong> ${n.Comments}</li>`),n.PrivateBuild&&(l+=`<li><strong>Private Build:</strong> ${n.PrivateBuild}</li>`),n.SpecialBuild&&(l+=`<li><strong>Special Build:</strong> ${n.SpecialBuild}</li>`),n.FileType&&(l+=`<li><strong>File Type:</strong> ${n.FileType}</li>`),n.FileOS&&(l+=`<li><strong>File OS:</strong> ${n.FileOS}</li>`),n.FileFlags&&(l+=`<li><strong>File Flags:</strong> ${n.FileFlags}</li>`),l+="</ul>",l+="<h3>Complete JSON Data</h3>",l+=`<pre>${JSON.stringify(n,null,2)}</pre>`}}catch(e){l+=`<div class="error">‚ö†Ô∏è Detailed analysis failed: ${e}</div>`}y.innerHTML=l,m.style.display="block",f.innerHTML='<div class="info">‚úÖ Analysis complete!</div>'}catch(e){f.innerHTML=`<div class="error">‚ùå Error analyzing file: ${e}</div>`}}else f.innerHTML='<div class="error">‚ö†Ô∏è Analyzer not ready yet. Please wait...</div>'}p.addEventListener("change",e=>{e.target.files.length>0&&b(e.target.files[0])}),_.addEventListener("dragover",e=>{e.preventDefault(),_.classList.add("dragover")}),_.addEventListener("dragleave",()=>{_.classList.remove("dragover")}),_.addEventListener("drop",e=>{e.preventDefault(),_.classList.remove("dragover"),e.dataTransfer.files.length>0&&b(e.dataTransfer.files[0])}),async function(){try{f.innerHTML='<div class="info">‚è≥ Loading analyzer...</div>',await d(),u=!0,f.innerHTML='<div class="info">‚úÖ Ready! Drop a file to analyze.</div>'}catch(e){f.innerHTML=`<div class="error">‚ùå Failed to load analyzer: ${e}</div>`}}();