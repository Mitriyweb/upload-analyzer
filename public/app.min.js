let e;export function __wbg_set_wasm(n){e=n}let n=null;function t(){return null!==n&&0!==n.byteLength||(n=new Uint8Array(e.memory.buffer)),n}let r=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});r.decode();let i=0;function o(e,n){return function(e,n){return i+=n,i>=2146435072&&(r=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),r.decode(),i=n),r.decode(t().subarray(e,e+n))}(e>>>=0,n)}let l=0;const a=new TextEncoder;"encodeInto"in a||(a.encodeInto=function(e,n){const t=a.encode(e);return n.set(t),{read:e.length,written:t.length}});let s=null;function c(){return(null===s||!0===s.buffer.detached||void 0===s.buffer.detached&&s.buffer!==e.memory.buffer)&&(s=new DataView(e.memory.buffer)),s}export function init_panic_hook(){e.init_panic_hook()}function d(e,n){const r=n(1*e.length,1)>>>0;return t().set(e,r/1),l=e.length,r}export function analyze_file(n){let t,r;try{const i=d(n,e.__wbindgen_malloc),a=l,s=e.analyze_file(i,a);return t=s[0],r=s[1],o(s[0],s[1])}finally{e.__wbindgen_free(t,r,1)}}export function get_file_info(n){let t,r;try{const i=d(n,e.__wbindgen_malloc),a=l,s=e.get_file_info(i,a);return t=s[0],r=s[1],o(s[0],s[1])}finally{e.__wbindgen_free(t,r,1)}}export function analyze_pe_file(n){let t,r;try{const i=d(n,e.__wbindgen_malloc),a=l,s=e.analyze_pe_file(i,a);return t=s[0],r=s[1],o(s[0],s[1])}finally{e.__wbindgen_free(t,r,1)}}export function __wbg_error_7534b8e9a36f1ab4(n,t){let r,i;try{r=n,i=t,console.error(o(n,t))}finally{e.__wbindgen_free(r,i,1)}}export function __wbg_new_8a6f238a6ece86ea(){return new Error}export function __wbg_stack_0ed75d68575b0f3c(n,r){const i=function(e,n,r){if(void 0===r){const r=a.encode(e),i=n(r.length,1)>>>0;return t().subarray(i,i+r.length).set(r),l=r.length,i}let i=e.length,o=n(i,1)>>>0;const s=t();let c=0;for(;c<i;c++){const n=e.charCodeAt(c);if(n>127)break;s[o+c]=n}if(c!==i){0!==c&&(e=e.slice(c)),o=r(o,i,i=c+3*e.length,1)>>>0;const n=t().subarray(o+c,o+i);c+=a.encodeInto(e,n).written,o=r(o,i,c,1)>>>0}return l=c,o}(r.stack,e.__wbindgen_malloc,e.__wbindgen_realloc),o=l;c().setInt32(n+4,o,!0),c().setInt32(n+0,i,!0)}export function __wbindgen_init_externref_table(){const n=e.__wbindgen_export_3,t=n.grow(4);n.set(0,void 0),n.set(t+0,void 0),n.set(t+1,null),n.set(t+2,!0),n.set(t+3,!1)}let f=!1;const g=document.getElementById("status"),u=document.getElementById("results"),_=document.getElementById("output"),y=document.getElementById("fileInput"),m=document.getElementById("uploadArea");async function p(e){if(f){g.innerHTML=`<div class="info">üîç Analyzing ${e.name}...</div>`,u.style.display="none";try{const n=await e.arrayBuffer(),t=new Uint8Array(n),r=get_file_info(t),i=JSON.parse(r);let o="<h3>Basic Information</h3>";if(o+=`<pre>${JSON.stringify(i,null,2)}</pre>`,i.type&&(i.type.includes("PE")||i.type.includes("MSI")))try{const e=analyze_pe_file(t),n=JSON.parse(e);if(n.error)o+=`<div class="error">‚ö†Ô∏è Analysis error: ${n.error}</div>`;else if(o+="<h3>Binary Metadata</h3>",0===Object.keys(n).length)o+="<p>No metadata found.</p>";else{if(o+="<ul>",n.Format&&(o+=`<li><strong>Format:</strong> ${n.Format}</li>`),n.Architecture&&(o+=`<li><strong>Architecture:</strong> ${n.Architecture}</li>`),n.Timestamp){o+=`<li><strong>Compile Date:</strong> ${new Date(1e3*parseInt(n.Timestamp)).toUTCString()}</li>`}n.FileDescription&&(o+=`<li><strong>Description:</strong> ${n.FileDescription}</li>`),n.ProductName&&(o+=`<li><strong>Product:</strong> ${n.ProductName}</li>`),n.CompanyName&&(o+=`<li><strong>Company:</strong> ${n.CompanyName}</li>`),n.ProductVersion&&(o+=`<li><strong>Version:</strong> ${n.ProductVersion}</li>`),n.FileVersion&&(o+=`<li><strong>File Version:</strong> ${n.FileVersion}</li>`),n.LegalCopyright&&(o+=`<li><strong>Copyright:</strong> ${n.LegalCopyright}</li>`),n.OriginalFilename&&(o+=`<li><strong>Original Filename:</strong> ${n.OriginalFilename}</li>`),n.InternalName&&(o+=`<li><strong>Internal Name:</strong> ${n.InternalName}</li>`),n.Comment&&(o+=`<li><strong>Comment:</strong> ${n.Comment}</li>`),o+="</ul>",o+="<h3>Complete JSON Data</h3>",o+=`<pre>${JSON.stringify(n,null,2)}</pre>`}}catch(e){o+=`<div class="error">‚ö†Ô∏è Detailed analysis failed: ${e}</div>`}_.innerHTML=o,u.style.display="block",g.innerHTML='<div class="info">‚úÖ Analysis complete!</div>'}catch(e){g.innerHTML=`<div class="error">‚ùå Error analyzing file: ${e}</div>`}}else g.innerHTML='<div class="error">‚ö†Ô∏è Analyzer not ready yet. Please wait...</div>'}y.addEventListener("change",e=>{e.target.files.length>0&&p(e.target.files[0])}),m.addEventListener("dragover",e=>{e.preventDefault(),m.classList.add("dragover")}),m.addEventListener("dragleave",()=>{m.classList.remove("dragover")}),m.addEventListener("drop",e=>{e.preventDefault(),m.classList.remove("dragover"),e.dataTransfer.files.length>0&&p(e.dataTransfer.files[0])}),async function(){try{g.innerHTML='<div class="info">‚è≥ Loading analyzer...</div>',await init(),f=!0,g.innerHTML='<div class="info">‚úÖ Ready! Drop a file to analyze.</div>'}catch(e){g.innerHTML=`<div class="error">‚ùå Failed to load analyzer: ${e}</div>`}}();