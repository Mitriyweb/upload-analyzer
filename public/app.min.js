let e,n=null;function t(){return null!==n&&0!==n.byteLength||(n=new Uint8Array(e.memory.buffer)),n}let i=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});i.decode();const r=2146435072;let o=0;function l(e,n){return function(e,n){return o+=n,o>=r&&(i=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),i.decode(),o=n),i.decode(t().subarray(e,e+n))}(e>>>=0,n)}let s=0;const a=new TextEncoder;"encodeInto"in a||(a.encodeInto=function(e,n){const t=a.encode(e);return n.set(t),{read:e.length,written:t.length}});let g=null;function c(){return(null===g||!0===g.buffer.detached||void 0===g.buffer.detached&&g.buffer!==e.memory.buffer)&&(g=new DataView(e.memory.buffer)),g}export function init_panic_hook(){e.init_panic_hook()}function d(e,n){const i=n(1*e.length,1)>>>0;return t().set(e,i/1),s=e.length,i}export function analyze_file(n){let t,i;try{const r=d(n,e.__wbindgen_malloc),o=s,a=e.analyze_file(r,o);return t=a[0],i=a[1],l(a[0],a[1])}finally{e.__wbindgen_free(t,i,1)}}export function get_file_info(n){let t,i;try{const r=d(n,e.__wbindgen_malloc),o=s,a=e.get_file_info(r,o);return t=a[0],i=a[1],l(a[0],a[1])}finally{e.__wbindgen_free(t,i,1)}}export function analyze_pe_file(n){let t,i;try{const r=d(n,e.__wbindgen_malloc),o=s,a=e.analyze_pe_file(r,o);return t=a[0],i=a[1],l(a[0],a[1])}finally{e.__wbindgen_free(t,i,1)}}const u=new Set(["basic","cors","default"]);function f(){const n={wbg:{}};return n.wbg.__wbg_error_7534b8e9a36f1ab4=function(n,t){let i,r;try{i=n,r=t,console.error(l(n,t))}finally{e.__wbindgen_free(i,r,1)}},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(n,i){const r=function(e,n,i){if(void 0===i){const i=a.encode(e),r=n(i.length,1)>>>0;return t().subarray(r,r+i.length).set(i),s=i.length,r}let r=e.length,o=n(r,1)>>>0;const l=t();let g=0;for(;g<r;g++){const n=e.charCodeAt(g);if(n>127)break;l[o+g]=n}if(g!==r){0!==g&&(e=e.slice(g)),o=i(o,r,r=g+3*e.length,1)>>>0;const n=t().subarray(o+g,o+r);g+=a.encodeInto(e,n).written,o=i(o,r,g,1)>>>0}return s=g,o}(i.stack,e.__wbindgen_malloc,e.__wbindgen_realloc),o=s;c().setInt32(n+4,o,!0),c().setInt32(n+0,r,!0)},n.wbg.__wbindgen_init_externref_table=function(){const n=e.__wbindgen_export_3,t=n.grow(4);n.set(0,void 0),n.set(t+0,void 0),n.set(t+1,null),n.set(t+2,!0),n.set(t+3,!1)},n}function m(t,i){return e=t.exports,p.__wbindgen_wasm_module=i,g=null,n=null,e.__wbindgen_start(),e}function y(n){if(void 0!==e)return e;void 0!==n&&(Object.getPrototypeOf(n)===Object.prototype?({module:n}=n):console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const t=f();n instanceof WebAssembly.Module||(n=new WebAssembly.Module(n));return m(new WebAssembly.Instance(n,t),n)}async function p(n){if(void 0!==e)return e;void 0!==n&&(Object.getPrototypeOf(n)===Object.prototype?({module_or_path:n}=n):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===n&&(n=new URL("./upload_analyzer_bg.wasm",import.meta.url));const t=f();("string"==typeof n||"function"==typeof Request&&n instanceof Request||"function"==typeof URL&&n instanceof URL)&&(n=fetch(n));const{instance:i,module:r}=await async function(e,n){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,n)}catch(n){if(!e.ok||!u.has(e.type)||"application/wasm"===e.headers.get("Content-Type"))throw n;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n)}const t=await e.arrayBuffer();return await WebAssembly.instantiate(t,n)}{const t=await WebAssembly.instantiate(e,n);return t instanceof WebAssembly.Instance?{instance:t,module:e}:t}}(await n,t);return m(i,r)}export{y as initSync};export default p;const b=p;window.init=b,window.analyze_file=analyze_file,window.get_file_info=get_file_info;let _=!1;const h=document.getElementById("status"),w=document.getElementById("results"),$=document.getElementById("output"),I=document.getElementById("fileInput"),S=document.getElementById("uploadArea");async function v(e){if(_){h.innerHTML=`<div class="info">üîç Analyzing ${e.name}...</div>`,w.style.display="none";try{const n=await e.arrayBuffer(),t=new Uint8Array(n),i=get_file_info(t),r=JSON.parse(i);let o="<h3>File Information</h3>";if(o+="<ul>",o+=`<li><strong>Filename:</strong> ${e.name}</li>`,o+=`<li><strong>Size:</strong> ${(e.size/1024).toFixed(2)} KB (${e.size.toLocaleString()} bytes)</li>`,o+=`<li><strong>Type:</strong> ${r.type||"Unknown"}</li>`,o+="</ul>",o+="<h3>Basic Information</h3>",o+=`<pre>${JSON.stringify(r,null,2)}</pre>`,r.type&&(r.type.includes("PE")||r.type.includes("MSI")||r.type.includes("DMG")))try{const e=analyze_file(t),n=JSON.parse(e);if(n.error)o+=`<div class="error">‚ö†Ô∏è Analysis error: ${n.error}</div>`;else if(o+="<h3>Binary Metadata</h3>",0===Object.keys(n).length)o+="<p>No metadata found.</p>";else{if(o+="<h4>File Header</h4>",o+="<ul>",n.Format&&(o+=`<li><strong>Format:</strong> ${n.Format}</li>`),n.InstallerType&&(o+=`<li><strong>‚öôÔ∏è Installer Type:</strong> ${n.InstallerType}</li>`),n.EmbeddedMSI&&(o+=`<li><strong>üì¶ Contains Embedded MSI:</strong> Yes (at offset ${n.MSIOffset})</li>`),n.Architecture&&(o+=`<li><strong>Architecture:</strong> ${n.Architecture}</li>`),n.Machine&&(o+=`<li><strong>Machine Type:</strong> ${n.Machine}</li>`),n.NumberOfSections&&(o+=`<li><strong>Number of Sections:</strong> ${n.NumberOfSections}</li>`),n.Characteristics&&(o+=`<li><strong>Characteristics:</strong> ${n.Characteristics}</li>`),n.PointerToSymbolTable&&(o+=`<li><strong>Symbol Table Pointer:</strong> ${n.PointerToSymbolTable}</li>`),n.NumberOfSymbols&&(o+=`<li><strong>Number of Symbols:</strong> ${n.NumberOfSymbols}</li>`),n.Timestamp){o+=`<li><strong>Compile Date:</strong> ${new Date(1e3*parseInt(n.Timestamp)).toUTCString()}</li>`}if(o+="</ul>",o+="<h4>Optional Header</h4>",o+="<ul>",n.EntryPoint&&(o+=`<li><strong>Entry Point:</strong> ${n.EntryPoint}</li>`),n.ImageBase&&(o+=`<li><strong>Image Base:</strong> ${n.ImageBase}</li>`),n.SizeOfImage&&(o+=`<li><strong>Size of Image:</strong> ${n.SizeOfImage} bytes</li>`),n.Subsystem&&(o+=`<li><strong>Subsystem:</strong> ${n.Subsystem}</li>`),n.DllCharacteristics&&(o+=`<li><strong>DLL Characteristics:</strong> ${n.DllCharacteristics}</li>`),o+="</ul>","MSI"===n.Format&&(o+="<h4>MSI Package Information</h4>",o+="<ul>",n.ProductCode&&(o+=`<li><strong>Product Code:</strong> ${n.ProductCode}</li>`),n.UpgradeCode&&(o+=`<li><strong>Upgrade Code:</strong> ${n.UpgradeCode}</li>`),n.InstallerFramework&&(o+=`<li><strong>‚öôÔ∏è Created With:</strong> ${n.InstallerFramework}</li>`),o+="</ul>"),"DMG"===n.Format&&(o+="<h4>DMG Disk Image Information</h4>",o+="<ul>",n.ImageType&&(o+=`<li><strong>Image Type:</strong> ${n.ImageType}</li>`),n.Compression&&(o+=`<li><strong>Compression:</strong> ${n.Compression}</li>`),n.HasKolySignature&&(o+=`<li><strong>UDIF Signature:</strong> ${"true"===n.HasKolySignature?"‚úì Present":"‚úó Missing"}</li>`),n.DMGVersion&&(o+=`<li><strong>DMG Version:</strong> ${n.DMGVersion}</li>`),o+="</ul>",o+="<h4>Application Bundle Information</h4>",o+="<ul>",n.BundleIdentifier&&(o+=`<li><strong>Bundle ID:</strong> ${n.BundleIdentifier}</li>`),n.ApplicationBundle&&(o+=`<li><strong>Application:</strong> ${n.ApplicationBundle}</li>`),n.ExecutableName&&(o+=`<li><strong>Executable:</strong> ${n.ExecutableName}</li>`),n.PackageType&&(o+=`<li><strong>Package Type:</strong> ${n.PackageType}</li>`),n.ApplicationCategory&&(o+=`<li><strong>üìÅ Category:</strong> ${n.ApplicationCategory}</li>`),n.MinimumSystemVersion&&(o+=`<li><strong>Min macOS:</strong> ${n.MinimumSystemVersion}</li>`),n.IconFile&&(o+=`<li><strong>Icon:</strong> ${n.IconFile}</li>`),n.PrincipalClass&&(o+=`<li><strong>Principal Class:</strong> ${n.PrincipalClass}</li>`),o+="</ul>"),o+="<h4>Version Information</h4>",o+="<ul>",n.FileVersionNumber&&(o+=`<li><strong>File Version (Binary):</strong> ${n.FileVersionNumber}</li>`),n.ProductVersionNumber&&(o+=`<li><strong>Product Version (Binary):</strong> ${n.ProductVersionNumber}</li>`),n.FileVersion&&(o+=`<li><strong>File Version (String):</strong> ${n.FileVersion}</li>`),n.ProductVersion&&(o+=`<li><strong>Product Version (String):</strong> ${n.ProductVersion}</li>`),n.SignedBy&&(o+=`<li><strong>üîê Digitally Signed By:</strong> ${n.SignedBy}</li>`),n.CompanyName){const e=n.NoStringsFound?" (from digital signature)":"";o+=`<li><strong>Company Name:</strong> ${n.CompanyName}${e}</li>`}n.Manufacturer&&(o+=`<li><strong>Manufacturer:</strong> ${n.Manufacturer}</li>`),n.ProductName&&(o+=`<li><strong>Product Name:</strong> ${n.ProductName}</li>`),n.FileDescription&&(o+=`<li><strong>File Description:</strong> ${n.FileDescription}</li>`),n.InternalName&&(o+=`<li><strong>Internal Name:</strong> ${n.InternalName}</li>`),n.OriginalFilename&&(o+=`<li><strong>Original Filename:</strong> ${n.OriginalFilename}</li>`),n.LegalCopyright&&(o+=`<li><strong>Legal Copyright:</strong> ${n.LegalCopyright}</li>`),n.LegalTrademarks&&(o+=`<li><strong>Legal Trademarks:</strong> ${n.LegalTrademarks}</li>`),n.Comments&&(o+=`<li><strong>Comments:</strong> ${n.Comments}</li>`),n.PrivateBuild&&(o+=`<li><strong>Private Build:</strong> ${n.PrivateBuild}</li>`),n.SpecialBuild&&(o+=`<li><strong>Special Build:</strong> ${n.SpecialBuild}</li>`),n.FileType&&(o+=`<li><strong>File Type:</strong> ${n.FileType}</li>`),n.FileOS&&(o+=`<li><strong>File OS:</strong> ${n.FileOS}</li>`),n.FileFlags&&(o+=`<li><strong>File Flags:</strong> ${n.FileFlags}</li>`),o+="</ul>",o+="<h3>Complete JSON Data</h3>",o+=`<pre>${JSON.stringify(n,null,2)}</pre>`}}catch(e){o+=`<div class="error">‚ö†Ô∏è Detailed analysis failed: ${e}</div>`}$.innerHTML=o,w.style.display="block",h.innerHTML='<div class="info">‚úÖ Analysis complete!</div>'}catch(e){h.innerHTML=`<div class="error">‚ùå Error analyzing file: ${e}</div>`}}else h.innerHTML='<div class="error">‚ö†Ô∏è Analyzer not ready yet. Please wait...</div>'}I.addEventListener("change",(e=>{e.target.files.length>0&&v(e.target.files[0])})),S.addEventListener("dragover",(e=>{e.preventDefault(),S.classList.add("dragover")})),S.addEventListener("dragleave",(()=>{S.classList.remove("dragover")})),S.addEventListener("drop",(e=>{e.preventDefault(),S.classList.remove("dragover"),e.dataTransfer.files.length>0&&v(e.dataTransfer.files[0])})),async function(){try{h.innerHTML='<div class="info">‚è≥ Loading analyzer...</div>',await b(),_=!0,h.innerHTML='<div class="info">‚úÖ Ready! Drop a file to analyze.</div>'}catch(e){h.innerHTML=`<div class="error">‚ùå Failed to load analyzer: ${e}</div>`}}();